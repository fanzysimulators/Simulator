<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/png" href="../../favicon.png">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Profiles — House of Villains</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="./style.css" />

<style>
  .skills-grid { display: grid; gap: 16px; grid-template-columns: repeat(2, minmax(240px, 1fr)); }
  @media (max-width: 900px){ .skills-grid { grid-template-columns: 1fr; } }
  .skill-card {
    display: grid; gap: 8px; padding: 12px; border-radius: 14px;
    border: 1px solid rgba(255,255,255,.12);
    background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04)), rgba(255,255,255,.06);
    backdrop-filter: blur(8px);
  }
  .skill-title { font-weight: 600; letter-spacing: .2px; }
  .skill-desc  { font-size: .82rem; color: var(--muted); line-height: 1.25; }
  .neo-select{
    --glow: rgba(106,169,255,.28);
    position:relative; width:100%; border-radius:12px; padding:1px;
    background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.08));
    box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 0 18px var(--glow);
    transition: box-shadow .25s ease, transform .2s ease; backdrop-filter: blur(var(--panel-blur));
  }
  .neo-select:focus-within{ box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset, 0 0 26px var(--glow); transform: translateY(-1px); }
  .neo-select select{
    appearance:none; -webkit-appearance:none; width:100%;
    border:none; outline:none; border-radius:10px;
    padding:12px 44px 12px 14px;
    font-weight:600;
    color:#f7f7f7;
    background:#111111;
    transition: background-color .25s ease, color .25s ease, box-shadow .2s ease;
    box-shadow: inset 0 1px 0 rgba(255,255,255,.12), inset 0 -1px 0 rgba(0,0,0,.5);
  }
  .neo-select::after{
    content:""; position:absolute; right:12px; top:50%; width:14px; height:14px; pointer-events:none; transform: translateY(-50%);
    background-image: url('data:image/svg+xml;utf8,<svg width="14" height="14" viewBox="0 0 24 24" fill="%23ffffff" xmlns="http://www.w3.org/2000/svg"><path opacity="0.9" d="M7 10l5 5 5-5"/></svg>');
    filter: drop-shadow(0 1px 2px rgba(0,0,0,.35)); opacity:.9;
  }
  .focus-avatar-wrap { display: grid; justify-items: center; gap: 8px; margin-bottom: 8px; }
  .focus-name { font-weight: 600; }
</style>
</head>
<body>
  <div class="bg fx-nebula" aria-hidden="true"></div>
  <div class="bg fx-hex" aria-hidden="true"></div>
  <div class="bg fx-circuit" aria-hidden="true"></div>
  <div class="bg fx-glow" aria-hidden="true"></div>

  <header class="site-header">
    <div class="brand">
      <span class="logo-dot" aria-hidden="true"></span>
      <h1>House of Villains — Profiles</h1>
    </div>
    <nav class="top-nav" aria-label="Primary">
      <a class="btn nav" href="../../index.html">Home</a>
      <button class="btn" id="btn-reset-session" type="button">Reset Season</button>
    </nav>
  </header>

  <div class="page-shell antm-shell">
    <aside class="sidebar left">
      <div class="panel">
        <h3>Profiles</h3>

        <div class="focus-avatar-wrap">
          <img id="focus-avatar" class="avatar ring" src="./BlankProfile.webp" alt="">
          <div id="focus-name" class="focus-name">Contestant</div>
        </div>
        <div class="filter" style="justify-content:center; margin-bottom:10px;">
          <select id="focus" aria-label="Choose focal contestant"></select>
        </div>

        <div class="stack" style="justify-content:center; margin-bottom:10px;">
          <button class="btn" id="prev" type="button">◀ Prev</button>
          <button class="btn" id="next" type="button">Next ▶</button>
        </div>

        <div class="sep"></div>

        <div class="stack" style="justify-content:center;">
          <button class="btn" id="rand-player" type="button">Randomize Player</button>
          <button class="btn" id="rand-all" type="button">Randomize Cast</button>
          <button class="btn" id="reset-player" type="button">Reset Player</button>
          <button class="btn" id="reset-all" type="button">Reset Cast</button>
        </div>

        <div class="sep"></div>
        <div class="stack" style="justify-content:center;">
          <a class="btn" href="./index.html">Back to Simulator</a>
        </div>
      </div>
    </aside>

    <main class="content">
      <section class="block">
        <header class="block-head center">
          <h2>Profiles</h2>
          <p class="muted">Set skill tiers for each contestant. Values are saved for this session.</p>
        </header>

        <div id="no-cast" class="center-text" hidden>
          <p class="muted">No cast found for this session. Go back and choose your cast first.</p>
          <div class="stack" style="justify-content:center;">
            <a class="btn" href="./index.html">Back</a>
          </div>
        </div>

        <div class="block-head center"><h3>Competition Skills</h3></div>
        <div id="skills-wrap" class="skills-grid"></div>

        <div class="sep"></div>
        <div class="block-head center"><h3>Social Skills</h3></div>
        <div id="social-wrap" class="skills-grid"></div>
      </section>
    </main>

    <aside class="sidebar right">
      <div class="panel">
        <h3>Tier Scale</h3>
        <ul class="bullet-list">
          <li><strong>+5</strong> — Exceptional</li>
          <li><strong>+4</strong> — Amazing</li>
          <li><strong>+3</strong> — Great</li>
          <li><strong>+2</strong> — Good</li>
          <li><strong>+1</strong> — Above Average</li>
          <li><strong>0</strong> — Average</li>
          <li><strong>-1</strong> — Below Average</li>
          <li><strong>-2</strong> — Passable</li>
          <li><strong>-3</strong> — Bad</li>
          <li><strong>-4</strong> — Terrible</li>
          <li><strong>-5</strong> — Abysmal</li>
        </ul>
      </div>
    </aside>
  </div>

  <script>
  (function(){
    "use strict";

    var KEY = "house-of-villains-season";
    var State = {
      load: function(){ try { return JSON.parse(sessionStorage.getItem(KEY)) || null; } catch(e){ return null; } },
      save: function(s){ sessionStorage.setItem(KEY, JSON.stringify(s)); },
      clear: function(){ sessionStorage.removeItem(KEY); }
    };

    var $ = function(s){ return document.querySelector(s); };

    $("#btn-reset-session").onclick = function(){ State.clear(); location.href="./index.html"; };

    var state = State.load();

    function mergedCast(){
      if(!state) return [];
      var a = Array.isArray(state.castVillains) ? state.castVillains.filter(Boolean) : [];
      return a;
    }
    function castIds(){ return mergedCast().map(function(c){return c.id;}); }
    function find(id){ return mergedCast().find(function(c){return c.id===id;}); }
    function nameOf(id){ var p=find(id); return p ? (p.nickname || p.name || id) : id; }
    function imgOf(id){ var p=find(id); return (p && p.image) || "./BlankProfile.webp"; }

    if(!state || !mergedCast().length){
      $("#no-cast").hidden = false;
      return;
    }

    var ids = castIds();
    $("#focus").innerHTML = ids.map(function(id){ return '<option value="'+id+'">'+nameOf(id)+'</option>'; }).join("");
    $("#focus").onchange = function(){ updateFocus(); renderSkills(); renderSocial(); };

    $("#prev").onclick = function(){
      var cur = $("#focus").value; var i = ids.indexOf(cur);
      $("#focus").value = ids[(i<=0 ? ids.length-1 : i-1)];
      updateFocus(); renderSkills(); renderSocial();
    };
    $("#next").onclick = function(){
      var cur = $("#focus").value; var i = ids.indexOf(cur);
      $("#focus").value = ids[(i>=ids.length-1 ? 0 : i+1)];
      updateFocus(); renderSkills(); renderSocial();
    };

    function updateFocus(){
      var id = $("#focus").value;
      $("#focus-avatar").src = imgOf(id);
      $("#focus-name").textContent = nameOf(id);
    }

    function ensureProfile(id){
      if(!state.profiles) state.profiles = {};
      if(!state.profiles[id]) state.profiles[id] = {};
      var keys = COMP_SKILLS.concat(SOC_SKILLS).map(function(k){return k[0];});
      for(var i=0;i<keys.length;i++){
        var k = keys[i];
        if(typeof state.profiles[id][k] !== "number") state.profiles[id][k] = 0;
      }
    }

    var COMP_SKILLS = [
      ["strength","Strength","Raw physical power, intimidation, and presence in head-to-head showdowns."],
      ["speed","Speed","How quickly they move, react, and complete time-sensitive tasks."],
      ["mental","Mental","Puzzles, memory, strategy, and pattern recognition under pressure."],
      ["connivance","Connivance","Scheming and cunning when twists, traps, or sabotage come into play."],
      ["teamwork","Team Work","Coordination and communication in partnered or group tasks."],
      ["eating","Eating","Tolerance and speed in gross-out or endurance eating challenges."]
    ];

    var SOC_SKILLS = [
      ["strategy","Strategy","Reads the house, plays votes, and positions themselves advantageously."],
      ["temperament","Temperament","Emotional control and composure under stress and conflict."],
      ["loyalty","Loyalty","Reliability as an ally vs. opportunism; perceived trustworthiness."]
    ];

    var TIERS = [5,4,3,2,1,0,-1,-2,-3,-4,-5];
    var LABELS_STD = {
      5:"+5 Exceptional",
      4:"+4 Amazing",
      3:"+3 Great",
      2:"+2 Good",
      1:"+1 Above Average",
      0:"0 Average",
      "-1":"-1 Below Average",
      "-2":"-2 Passable",
      "-3":"-3 Bad",
      "-4":"-4 Terrible",
      "-5":"-5 Abysmal"
    };

    var LABELS_STRAT = {
      5:"+5 Mastermind",
      4:"+4 Tactical Genius",
      3:"+3 Calculated Planner",
      2:"+2 Strategic Thinker",
      1:"+1 Situational Player",
      0:"0 Basic Awareness",
      "-1":"-1 Short-Sighted",
      "-2":"-2 Uncoordinated",
      "-3":"-3 Impulsive",
      "-4":"-4 Chaotic Decision-Maker",
      "-5":"-5 Strategically Lost"
    };

    var LABELS_TEMP = {
      5:"+5: Untouchable Calm",
      4:"+4: Deeply Centered",
      3:"+3: Zen Master",
      2:"+2: Diplomat",
      1:"+1: Composed",
      0:"0: Regular",
      "-1":"-1: Angered",
      "-2":"-2: Furious",
      "-3":"-3: Fuming",
      "-4":"-4: Volcanic",
      "-5":"-5: Nuclear Meltdown"
    };

    var LABELS_LOY  = {
      5:"+5: Ride-or-Die Ally",
      4:"+4: Ironclad Partner",
      3:"+3: Unshakeable Ally",
      2:"+2: Devoted Partner",
      1:"+1: Team Player",
      0:"0: Pragmatic",
      "-1":"-1: Fair-Weather Friend",
      "-2":"-2: Cunning Manipulator",
      "-3":"-3: Agent of Chaos",
      "-4":"-4: Backstabber",
      "-5":"-5: Walking Betrayal"
    };

    function selectHTML(valMap){
      return TIERS.map(function(v){ return '<option value="'+v+'">'+valMap[String(v)]+'</option>'; }).join("");
    }

    function cardHTML(key,title,desc,labels){
      return '<div class="skill-card">'+
        '<div class="skill-title">'+title+'</div>'+
        '<div class="skill-desc">'+desc+'</div>'+
        '<div class="neo-select"><select data-skill="'+key+'">'+ selectHTML(labels) +'</select></div>'+
      '</div>';
    }

    function renderSkills(){
      var id=$("#focus").value; if(!id) return;
      ensureProfile(id);
      var wrap=$("#skills-wrap"); wrap.innerHTML="";
      for(var i=0;i<COMP_SKILLS.length;i++){
        var def=COMP_SKILLS[i]; var holder=document.createElement("div");
        holder.innerHTML = cardHTML(def[0],def[1],def[2],LABELS_STD);
        var node=holder.firstElementChild, sel=node.querySelector("select");
        sel.value = String(state.profiles[id][def[0]]);
        sel.onchange = function(e){
          var k=e.target.getAttribute("data-skill");
          state.profiles[id][k]=Number(e.target.value);
          State.save(state);
        };
        wrap.appendChild(node);
      }
    }

    function renderSocial(){
      var id=$("#focus").value; if(!id) return;
      ensureProfile(id);
      var wrap=$("#social-wrap"); wrap.innerHTML="";
      (function(){
        var holder=document.createElement("div");
        holder.innerHTML = cardHTML("strategy","Strategy",SOC_SKILLS[0][2],LABELS_STRAT);
        var node=holder.firstElementChild, sel=node.querySelector("select");
        sel.value=String(state.profiles[id]["strategy"]);
        sel.onchange=function(e){ state.profiles[id]["strategy"]=Number(e.target.value); State.save(state); };
        wrap.appendChild(node);
      })();
      (function(){
        var holder=document.createElement("div");
        holder.innerHTML = cardHTML("temperament","Temperament",SOC_SKILLS[1][2],LABELS_TEMP);
        var node=holder.firstElementChild, sel=node.querySelector("select");
        sel.value=String(state.profiles[id]["temperament"]);
        sel.onchange=function(e){ state.profiles[id]["temperament"]=Number(e.target.value); State.save(state); };
        wrap.appendChild(node);
      })();
      (function(){
        var holder=document.createElement("div");
        holder.innerHTML = cardHTML("loyalty","Loyalty",SOC_SKILLS[2][2],LABELS_LOY);
        var node=holder.firstElementChild, sel=node.querySelector("select");
        sel.value=String(state.profiles[id]["loyalty"]);
        sel.onchange=function(e){ state.profiles[id]["loyalty"]=Number(e.target.value); State.save(state); };
        wrap.appendChild(node);
      })();
    }

    function randomTier(){ return TIERS[Math.floor(Math.random()*TIERS.length)]; }

    $("#rand-player").onclick=function(){
      var id=$("#focus").value; if(!id) return;
      ensureProfile(id);
      COMP_SKILLS.concat(SOC_SKILLS).forEach(function(def){
        state.profiles[id][def[0]] = randomTier();
      });
      State.save(state); renderSkills(); renderSocial();
    };
    $("#rand-all").onclick=function(){
      ids.forEach(function(id){
        ensureProfile(id);
        COMP_SKILLS.concat(SOC_SKILLS).forEach(function(def){
          state.profiles[id][def[0]] = randomTier();
        });
      });
      State.save(state); renderSkills(); renderSocial();
    };
    $("#reset-player").onclick=function(){
      var id=$("#focus").value; if(!id) return;
      ensureProfile(id);
      COMP_SKILLS.concat(SOC_SKILLS).forEach(function(def){
        state.profiles[id][def[0]] = 0;
      });
      State.save(state); renderSkills(); renderSocial();
    };
    $("#reset-all").onclick=function(){
      if(!state.profiles) state.profiles={};
      ids.forEach(function(id){
        ensureProfile(id);
        COMP_SKILLS.concat(SOC_SKILLS).forEach(function(def){ state.profiles[id][def[0]] = 0; });
      });
      State.save(state); renderSkills(); renderSocial();
    };

    updateFocus(); renderSkills(); renderSocial();
  })();
  </script>
</body>
</html>
